<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width" />
    <title>Form</title>
    <style>
      /* style.css */

      body {
  font-family: Arial, sans-serif;
  background-color: #f5f5f5;
  margin: 0;
  padding: 0;
  text-align: center;
}

h1 {
  color: #333;
}

.main-div {
  background-color: #fff;
  padding: 20px;
  border-radius: 8px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
  display: inline-block;
  margin-top: 10px;
  width: 90%;
  max-width: 600px;
  box-sizing: border-box;
}

form {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.form-group {
  margin-bottom: 15px;
  text-align: left;
  width: 100%;
}

label {
  display: block;
  margin-bottom: 5px;
  font-weight: bold;
}

input[type="text"],
input[type="tel"],
input[type="email"],
input[type="password"] {
  width: 100%;
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}

input[type="submit"] {
  background-color: #4caf50;
  color: white;
  padding: 10px 20px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 16px;
  transition: background-color 0.3s ease;
}

input[type="submit"]:hover {
  background-color: #45a049;
}

  #fetch-button {
    background-color: rgb(0, 168, 180); 
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
    margin-bottom: 30px;
    transition: background-color 0.3s ease;
  }

  #fetch-button:hover {
    background-color:  aquamarine;
  }

.address-fieldset {
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 10px;
  width: 100%;
  box-sizing: border-box;
}

#fetch-fieldset {
  border: 1px solid #ccc;
  border-radius: 4px;
  align-items: center;
  padding: 20px;
  width: 50%;
  max-width: fit-content;
  box-sizing: border-box;
  margin:20px 0px 20px 0px;
  
}

  #fetch-div {
    display: flex;
    justify-content: center; /* Centers horizontally */
    align-items: center; /* Centers vertically */
    height: 40vh; /* Makes the div take the full height of the viewport */
  }


legend {
  font-weight: bold;
  padding: 0 10px;
}

.login-fieldset {
  border: 1px solid #ccc;
  border-radius: 4px;
  padding: 10px;
  width: 100%;
  box-sizing: border-box;
}

.error-message {
  color: red;
  font-size: 12px;
  margin-top: 5px;
}

@media (max-width: 600px) {
  .main-div {
    width: 90%;
    padding: 15px;
  }
}
</style>
  </head>

  <body>
  
    <h1>User Form</h1>
    <form method="post" id="form-id" onsubmit="return validateForm()">
      <div class="main-div">
        <div class="form-group">
          <label for="first-name">First Name</label>
          <input
            type="text"
            id="first-name"
            name="first-name"
            placeholder="Enter your first name"
            required
            pattern="[A-Za-z\s]+"
            title="Please enter only alphabetic characters"
          /><br />
        </div>
        <div class="form-group">
          <label for="last-name">Last Name</label>
          <input
            type="text"
            id="last-name"
            name="last-name"
            placeholder="Enter your last name"
            required
            pattern="[A-Za-z\s]+"
            title="Please enter only alphabetic characters"
          /><br />
        </div>
        <div class="form-group">
          <label for="mobile-no">Mobile No</label>
          <input
            type="tel"
            id="mobile-no"
            name="mobile-no"
            placeholder="Enter Mobile number"
            required
            pattern="\d{10}"
            maxlength="10"
          /><br />
          <span id="mobile-error" class="error-message"></span>
        </div>
        <div class="form-group">
          <label for="email-id">Email ID</label>
          <input
            type="email"
            id="email-id"
            name="email-id"
            placeholder="Enter Email ID"
            required
          /><br />
          <span id="email-error" class="error-message"></span>
        </div>
        <div class="form-group">
          <label for="address">Address</label>
          <input
            type="text"
            id="address"
            name="address"
            placeholder="Enter your Address"
          /><br />
        </div>
        <fieldset class="address-fieldset">
          <legend>Address Details</legend>
          <div class="form-group">
            <label for="street">Street</label>
            <input type="text" id="street" name="street" /><br />
          </div>
          <div class="form-group">
            <label for="city">City</label>
            <input
              type="text"
              id="city"
              name="city"
              placeholder="Enter your city"
              pattern="[A-Za-z\s]+"
              title="Please enter only alphabetic characters"
            /><br /></div>
          <div class="form-group">
            <div class="form-group">
              <label for="state">State</label>
              <input
                type="text"
                id="state"
                name="state"
                placeholder="Enter your state"
                pattern="[A-Za-z\s]+"
                title="Please enter only alphabetic characters"
              /><br />
            </div>
            <div class="form-group">
              <label for="country">Country</label>
              <input
                type="text"
                id="country"
                name="country"
                placeholder="Enter your country"
                pattern="[A-Za-z\s]+"
                title="Please enter only alphabetic characters"
              /><br /></div>
        </fieldset>
        <fieldset class="login-fieldset">
          <legend>Login Details</legend>
          <div class="form-group">
            <label for="login-id">Login ID</label>
            <input
              type="text"
              id="login-id"
              name="login-id"
              placeholder="Enter Login ID"
              required
              pattern="[a-zA-Z0-9]{8,}"
              title="Login ID must be at least 8 characters long and alphanumeric"
            /><br />
            <span id="login-error" class="error-message"></span>
          </div>
          <div class="form-group">
            <label for="password">Password</label>
            <input
              type="password"
              id="password"
              name="password"
              placeholder="Enter Password"
              required
              pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$"
              title="Password must be at least 8 characters long and include at least one uppercase letter, one lowercase letter, one number, and one special character"
            /><br />
            <span id="password-error" class="error-message"></span>
          </div>
        </fieldset>
      </div>
      <input type="submit" value="Save Data" />
    </form>
    <div id="fetch-div">
      <fieldset id="fetch-fieldset">
      <h1 style="padding-top: 20px;";>Here You can Fetch User Data</h1>
      <button id="fetch-button" type="button" onclick="location.href='/fetchUsers'">Fetch Here</button>
    </fieldset>
    </div>
    <script>
      function validateForm() {
        const firstName = document.getElementById("first-name").value;
        const lastName = document.getElementById("last-name").value;
        const mobileNo = document.getElementById("mobile-no").value;
        const email = document.getElementById("email-id").value;
        const loginId = document.getElementById("login-id").value;
        const password = document.getElementById("password").value;

        let valid = true;

        // Mobile number validation
        const mobilePattern = /^\d{10}$/;
        if (!mobilePattern.test(mobileNo)) {
          document.getElementById("mobile-error").textContent =
            "Mobile number must be 10 digits";
          valid = false;
        } else {
          document.getElementById("mobile-error").textContent = "";
        }

        // Email validation
        const emailPattern = /\S+@\S+\.\S+/;
        if (!emailPattern.test(email)) {
          document.getElementById("email-error").textContent =
            "Invalid email format";
          valid = false;
        } else {
          document.getElementById("email-error").textContent = "";
        }

        // Login ID validation
        const loginIdPattern = /^[a-zA-Z0-9]{8,}$/;
        if (!loginIdPattern.test(loginId)) {
          document.getElementById("login-error").textContent =
            "Login ID must be at least 8 characters and alphanumeric";
          valid = false;
        } else {
          document.getElementById("login-error").textContent = "";
        }

        // Password validation
        const passwordPattern =
          /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
        if (!passwordPattern.test(password)) {
          document.getElementById("password-error").textContent =
            "Password must be at least 8 characters with one lowercase, one uppercase, one number, and one special character";
          valid = false;
        } else {
          document.getElementById("password-error").textContent = "";
        }

        return valid;
      }

      document
        .getElementById("form-id")
        .addEventListener("submit", function (event) {
          event.preventDefault(); // Prevent form submission

          if (validateForm()) {
            const data = {
              firstName: document.getElementById("first-name").value,
              lastName: document.getElementById("last-name").value,
              mobileNo: document.getElementById("mobile-no").value,
              email: document.getElementById("email-id").value,
              address: {
                street: document.getElementById("street").value,
                city: document.getElementById("city").value,
                state: document.getElementById("state").value,
                country: document.getElementById("country").value,
              },
              loginId: document.getElementById("login-id").value,
              password: document.getElementById("password").value,
            };

            fetch("/createUser", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify(data),
            })
              .then((response) => response.json())
              .then((data) => {
                if (!data.errors) {
                  alert("User saved successfully!");
                  document.getElementById("form-id").reset();
                } else {
                  data.errors.forEach((error) => {
                    alert(error.message);
                  });
                }
              })
              .catch((error) => {
                alert("Can't save user: " + error.message);
              });
          }
        });
    </script>
  </body>
</html>
